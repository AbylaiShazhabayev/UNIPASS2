var tableGruposDisponiveis,checkAdicionarGrupo;function carregarGruposDisponiveis(){tableGruposDisponiveis.block(),tableGruposDisponiveis.api().ajax.url("api/passwords/"+senhaId+"/groups/available").load(function(){tableGruposDisponiveis.unblock()})}$("#btnGruposAdicionar").click(function(){$("#modalGruposDisponiveis").modal("show"),carregarGruposDisponiveis(),checkAdicionarGrupo=[]}),(tableGruposDisponiveis=$("#tableGruposDisponiveis").dataTable({autoWidth:!1,order:[1,"asc"],deferLoading:0,buttons:[],columns:[{data:"id",orderable:!1,className:"align-middle v-middle",render:function(e){return'<label class="custom-control custom-checkbox m-0"><input type="checkbox" class="custom-control-input btnCheckGrupo" data-id="'+e+'"><span class="custom-control-label">&nbsp;</span></label>'}},{data:"name",width:"45%"},{data:"id",width:"55%",orderable:!1,render:function(e){return'<div data-group="'+e+'"><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_view" checked disabled><span class="custom-control-label">View</span></label><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_edit"><span class="custom-control-label">Edit</span></label><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_delete"><span class="custom-control-label">Exclude</span></label><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_share"><span class="custom-control-label">Share</span></label></div>'}}],drawCallback:function(){$("#tableGruposDisponiveis").find('input[name="can_view"], input[name="can_edit"], input[name="can_delete"], input[name="can_share"]').on("change",function(){let e=$(this).parents("div"),n=e.attr("data-group");checkAdicionarGrupo=checkAdicionarGrupo.filter(function(c){return c.group_id==n&&(c.can_view=e.find('input[name="can_view"]').is(":checked")?1:0,c.can_edit=e.find('input[name="can_edit"]').is(":checked")?1:0,c.can_delete=e.find('input[name="can_delete"]').is(":checked")?1:0,c.can_share=e.find('input[name="can_share"]').is(":checked")?1:0),!0})})}})).on("click","tbody > tr .btnCheckGrupo",function(){var e=$(this).attr("data-id");$(this).is(":checked")?checkAdicionarGrupo.push({password_id:senhaId,group_id:e,can_view:$(this).parents("tr").find('input[name="can_view"]').is(":checked")?1:0,can_edit:$(this).parents("tr").find('input[name="can_edit"]').is(":checked")?1:0,can_delete:$(this).parents("tr").find('input[name="can_delete"]').is(":checked")?1:0,can_share:$(this).parents("tr").find('input[name="can_share"]').is(":checked")?1:0}):checkAdicionarGrupo=checkAdicionarGrupo.filter(function(n){return n.group_id!=e}),$("#btnGruposSalvar").toggleClass("disabled",0===checkAdicionarGrupo.length)}),$("#btnGruposSalvar").click(function(){let e="shareds="+JSON.stringify(checkAdicionarGrupo),n=$("#modalGruposDisponiveis"),c=n.find(".modal-content");c.block(),$.request({url:"api/passwords/"+senhaId+"/shareds",method:"POST",data:e,error:function(){c.unblock()},after:function(){$.notify({message:"Password shared"},{type:"success"}),carregarCompartilhamentos(),n.modal("hide"),c.unblock()}})});